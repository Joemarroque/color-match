<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Color Match</title>
  <style>
    body {
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: #222;
      color: #fff;
      margin: 0;
      position: relative;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(4, 80px);
      grid-gap: 10px;
      margin-bottom: 20px;
    }
    .tile {
      width: 80px;
      height: 80px;
      background: #444;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.5s, border 0.3s;
      border: 2px solid #666;
    }
    .revealed {
      border: 2px solid #fff;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      background: #08f;
      border: none;
      border-radius: 6px;
      color: white;
      cursor: pointer;
    }
    #turns {
      margin-bottom: 15px;
      font-size: 18px;
    }
    #musicToggle {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 40px;
      height: 40px;
      background: #333;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 20px;
    }
    #musicToggle .indicator {
      display: inline-block;
      margin-left: 4px;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: red;
    }
  </style>
</head>
<body>

<h2>Color Match</h2>
<div id="turns">Turns left: 10</div>
<div class="grid" id="gameGrid"></div>
<button id="playAgain" style="display: none;">Play Again</button>

<button id="musicToggle">ðŸŽµ<span class="indicator"></span></button>

<audio id="clickSound" src="click.mp3"></audio>
<audio id="gameOverSound" src="gameover.mp3"></audio>
<audio id="bgMusic" src="bg-music.mp3" loop></audio>
  
<script>
  const colors = ["red", "blue", "green", "yellow", "orange", "purple", "cyan", "pink"];
  let tiles = [...colors, ...colors];
  tiles = tiles.sort(() => 0.5 - Math.random());

  const grid = document.getElementById('gameGrid');
  const turnsDisplay = document.getElementById('turns');
  const playAgainBtn = document.getElementById('playAgain');
  const musicToggleBtn = document.getElementById('musicToggle');
  const musicIndicator = musicToggleBtn.querySelector('.indicator');
  const bgMusic = document.getElementById('bgMusic');

  let firstTile = null;
  let secondTile = null;
  let lockBoard = false;
  let remainingTurns = 10;
  let streak = 0;
  let gameEnded = false;

  function updateTurns() {
    turnsDisplay.textContent = `Turns left: ${remainingTurns}`;
  }

  musicToggleBtn.addEventListener('click', () => {
    if (bgMusic.paused) {
      bgMusic.play();
      musicIndicator.style.background = 'lime';
    } else {
      bgMusic.pause();
      musicIndicator.style.background = 'red';
    }
  });

  function endGame(message) {
    gameEnded = true;
    bgMusic.pause();
    bgMusic.currentTime = 0;

    const gameOverSound = document.getElementById('gameOverSound');
    gameOverSound.play();

    const soundDuration = 1000;
    setTimeout(() => {
      alert(message);
      playAgainBtn.style.display = 'block';
    }, soundDuration);
  }

  tiles.forEach((color, index) => {
    const tile = document.createElement('div');
    tile.className = 'tile';
    tile.dataset.color = color;
    tile.dataset.index = index;

    tile.addEventListener('click', () => {
      if (lockBoard || tile.classList.contains('revealed') || tile === firstTile || remainingTurns <= 0 || gameEnded) return;

      document.getElementById('clickSound').play();
      tile.style.background = color;

      if (!firstTile) {
        firstTile = tile;
      } else {
        secondTile = tile;
        lockBoard = true;

        if (firstTile.dataset.color === secondTile.dataset.color) {
          streak++;
          if (streak > 1) {
            remainingTurns++;
          }
          updateTurns();
          firstTile.classList.add('revealed');
          secondTile.classList.add('revealed');
          reset();
          checkGameOver();
        } else {
          streak = 0;
          remainingTurns--;
          updateTurns();

          setTimeout(() => {
            firstTile.style.background = "#444";
            secondTile.style.background = "#444";
            reset();

            if (remainingTurns === 0 && document.querySelectorAll('.tile.revealed').length < tiles.length) {
              endGame("Game Over! You ran out of turnsðŸ‘¹");
            }
          }, 800);
        }
      }
    });

    grid.appendChild(tile);
  });

  function reset() {
    [firstTile, secondTile] = [null, null];
    lockBoard = false;
  }

  function checkGameOver() {
    const allRevealed = document.querySelectorAll('.tile.revealed');
    if (allRevealed.length === tiles.length) {
      endGame("ðŸŽ‰ Congratulations! You matched all colorsðŸ¤©");
    }
  }

  playAgainBtn.addEventListener('click', () => {
    location.reload();
  });

  updateTurns();
  musicIndicator.style.background = 'red';
</script>

</body>
</html>
